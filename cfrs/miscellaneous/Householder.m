% Test the Householder transformation
clear all
% A = [4  3  2  1
%      4  3  2  1
%      4  3  2  1
%      4  3  2  1
%      4  3  2  1];
% N = 4;
% M = 5;
%  
% sum = 0;
% for i=2:M
%     sum = sum+A(i,1)^2;
% end
% s = sqrt(A(1,1)^2 + sum);
% s = -s;

% A = [4  3  2  1  5
%      0  3  2  1  6
%      0  0  2  -1  7
%      0  0  0  0  0
%      0  0  0  0  0
%      0  0  0  0  0]
% 
% s = sqrt(2^2 + 1^2 + 7^2);
% s = -s
% h = 2 - s;
% b = h*s;
% u = [0 0 h -1 7];
% 
% M = u'*u/b;
% 
% Q = eye(5) + M;
% 
% K = A*Q
% 
% % v = [0  0  2  -1  7]
% % 
% % t = u*v'/b
% 
% sum = K(2,2)^2 + K(2,4)^2 + K(2,5)^2;
% s = sqrt(sum);
% h = K(2,2)-s;
% b = h*s;
% u = [0  h  0  K(2,4) K(2,5)];
% M = u'*u/b;
% 
% Q = eye(5) + M;
% v = [K(2,1) K(2,2)  K(2,3)  K(2,4)  K(2,5)];
% Q*v';
% 
% K = K*Q


% A = [  -1.155115e+00 -4.819544e-01 -1.220544e-01 -7.857143e-01 -2.519890e-01
%  3.300330e-01 -4.575371e-01 -2.315403e-01 -3.604034e-01 -3.714772e-01
%  4.950495e-01 1.979304e-01 5.415139e-02 -5.255887e-02 4.691337e-02
%  0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
%  0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
%  0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00]
% 
% B=[ 4.336114e-16
%  -1.165837e-16
%  -4.576184e-17
%  0.000000e+00
%  0.000000e+00
%  0.000000e+00]

A=[-0.000000e+00 0.000000e+00 -0.000000e+00 0.000000e+00
 -1.185257e-01 1.197109e-01 -8.564321e-02 4.579393e-02
 -9.900990e-01 5.000000e-01 -2.104167e-01 6.375625e-02
 9.900990e-01 5.000000e-01 2.104167e-01 6.375625e-02
 4.950495e-01 5.000000e-01 3.577083e-01 1.912687e-01
 3.300330e-01 5.000000e-01 5.190278e-01 4.037896e-01]

B=[ 0.000000e+00
 2.471077e-01
 4.353389e-16
 0.000000e+00
 0.000000e+00
 0.000000e+00]


X = pinv(A)*B

Rez = norm(A*X-B)

X=[ 3.533153e-01
 -2.017279e-01
 -1.607080e+00
 2.130703e+00]


Rez = norm(A*X-B)


% sum = A(3,3)^2 + A(3,4)^2 + A(3,5)^2;
% s = sqrt(sum);
% s = -s;
% h = A(3,3)-s;
% b = h*s;
% u = [0  0  h  A(3,4) A(3,5)];
% M = u'*u/b;
% % 
%  Q = eye(5) + M;
%  K = A*Q
%  
%  X=[1; 1; 1; 1; 1]
%  X = Q'*X
% 
% sum = K(2,2)^2 + K(2,4)^2 + K(2,5)^2;
% s = sqrt(sum);
% s = s;
% h = K(2,2)-s;
% b = h*s;
% u = [0  h  0  K(2,4) K(2,5)];
% M = u'*u/b;
% % 
%  Q = eye(5) + M;
%  K = K*Q
%  
%  X = Q'*X
% 
% sum = K(1,1)^2 + K(1,4)^2 + K(1,5)^2;
% s = sqrt(sum);
% s = s;
% h = K(1,1)-s;
% b = h*s;
% u = [h  0  0  K(1,4) K(1,5)];
% M = u'*u/b;
% % 
%  Q = eye(5) + M;
%  K = K*Q
% 
 
%   
% B = [  -1.155115e+00 -4.819544e-01 -1.220544e-01 -7.857143e-01 -2.519890e-01
%  3.300330e-01 -4.575371e-01 -2.315403e-01 -3.604034e-01 -3.714772e-01
%  4.950495e-01 1.979304e-01 5.415139e-02 -5.255887e-02 4.691337e-02
%  0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
%  0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
%  0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00]
% 
% C = [ -1.155115e+00 -4.819544e-01 -2.573240e-01 -7.359998e-01 -2.963635e-01
%  3.300330e-01 -4.575371e-01 1.240533e-01 -4.910917e-01 -2.548265e-01
%  4.950495e-01 1.979304e-01 -8.885759e-02 -5.255887e-02 4.691337e-02
%  0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
%  0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
%  0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00]
% 
% D = [ -1.155115e+00 9.157734e-01 -2.573240e-01 -1.520596e-01 6.641983e-03
%  3.300330e-01 7.179470e-01 1.240533e-01 -4.910917e-01 -2.548265e-01
%  4.950495e-01 1.979304e-01 -8.885759e-02 -5.255887e-02 4.691337e-02
%  0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
%  0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
%  0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00]

A = [1.0000000000000002e+00 -2.4661993871715446e-17 2.9622652517789626e-02 -6.6353950584864963e-17 4.7263724542131336e-03 8.7951424809011441e-03
 3.3946945079147986e-02 -1.8089347393665398e-02 1.0292770092786240e-02 -1.8078146446936505e-02 1.0094389683259042e-02 1.0259571606716063e-02
 5.3381395221378442e-02 -2.9941881841743026e-02 1.7959984618168074e-02 -1.1487571764126790e-02 7.1097679157934059e-03 3.3591689484158520e-03
 5.0954522888144574e-02 -3.0967847972419586e-02 2.0136665957471177e-02 4.7660558466199217e-03 -2.2388797919603476e-03 1.2471092730181410e-03
 1.9597327477949206e-01 8.2200543561808132e-04 5.5835688979630829e-03 -6.1441619143997636e-02 6.1519409902400374e-04 2.1025758377389622e-02
 2.0201732935567901e-01 -2.4547398331023619e-03 6.5117399880873089e-03 6.2339162531003710e-02 4.1964829421362211e-04 2.1077736542166752e-02
 4.3426046032934790e-02 2.5520726469999672e-02 1.6234592204499177e-02 -1.3614951244181099e-02 -8.1946978180910315e-03 4.6591329976052196e-03
 5.4997546332030411e-02 3.2551780428873120e-02 2.0895821987025980e-02 -3.7549406423056472e-18 -2.5993888803302128e-04 4.8371125609016926e-04
 4.1877322834985575e-02 2.5295079456655347e-02 1.6622611090358466e-02 1.2922640067066562e-02 7.5616216090955901e-03 4.3693240605760762e-03
 7.4232507194239824e-03 -6.8940303711694595e-03 6.4639103257821458e-03 -9.7720780634657969e-03 9.1780504854711963e-03 1.3122456120584988e-02
 1.0630463007739616e-02 -1.0073547325740954e-02 9.6505363926603378e-03 -1.0165482843607304e-02 9.7732477549164285e-03 1.0050742289962267e-02
 1.3726328008065258e-02 -1.3926576246520326e-02 1.4318793397212303e-02 -8.3970718025633464e-03 8.6880101088392704e-03 5.5047499290025465e-03
 1.4520482673618024e-02 -1.6217539585068472e-02 1.8380216952813933e-02 -4.0929756454973609e-03 4.7728929894180370e-03 1.5169191401598102e-03
 1.3761118664020454e-02 -1.6260732041460457e-02 1.9511768550159264e-02 8.4807643085891399e-04 -7.7814278664977267e-04 3.8777742171862569e-04
 1.8785381972549146e-02 -9.9996497040623789e-03 5.6730457891254731e-03 -1.6184509955820013e-02 8.8885643348790063e-03 1.4325887444279210e-02
 3.3939193760163848e-02 -2.1446908306123540e-02 1.4515345240404346e-02 1.3925683116237106e-02 -8.3331346185127365e-03 6.2449120211616463e-03
 4.8322016003543661e-02 5.0387596538931219e-05 1.3963269878634059e-03 -3.0512305253822737e-02 1.8999978331427943e-04 1.9711068462539363e-02
 5.0181580155856338e-02 -9.7207098973354762e-04 1.6879657977276915e-03 3.1078705864542876e-02 -2.6054131701588954e-04 1.9733957409794126e-02
 2.5764521432226094e-02 1.5222560717831618e-02 9.7384807350330421e-03 -1.6268670218582977e-02 -9.7303558695350408e-03 1.0509624553287029e-02
 2.5445014328112494e-02 1.5553214878911880e-02 1.0353222002739665e-02 1.5758732857083992e-02 9.4593406483940608e-03 1.0006277751378722e-02
 9.6042150229332449e-03 1.0796934819280424e-02 1.2316782856234046e-02 -8.2744931076536611e-03 -9.4418495134306595e-03 7.3242536995124273e-03
 1.2440864115468426e-02 1.3992838278839766e-02 1.5977904976457933e-02 -6.6252725504901359e-03 -7.6207344326412541e-03 3.7599240798982694e-03
 1.4009907131769512e-02 1.6150365645603085e-02 1.8923715752914325e-02 -3.0149045920871702e-03 -3.6504058151895381e-03 8.8161137062941466e-04
 1.3306938502806336e-02 1.5963423970063628e-02 1.9493856582614592e-02 1.2446709037220323e-03 1.3213827294003395e-03 3.2568662135767083e-04
 1.1564341977911115e-02 1.4152424589629965e-02 1.7647703459713823e-02 4.7449966834866679e-03 5.6478622093689874e-03 2.1278731234755394e-03 ];


B = [ 6.2719460647035363e-01 -6.6214805374521944e+01 -3.6055240098975980e+02 3.9780949744138714e+04
 2.2873827323978663e-02 -7.0775140374933097e+00 -9.3693998317435696e+00 1.5036144448662844e+03
 4.1164175713378125e-02 -8.9377740515622808e+00 -1.3955174843950527e+01 2.8349839143467843e+03
 4.3706154368914694e-02 -6.7050577652294443e+00 -1.2356705090622787e+01 3.1366593642129710e+03
 8.4029198283824269e-02 -1.5508506791866809e+01 -8.5474601865158519e+01 4.5999813552770584e+03
 1.5690362592186138e-01 -1.0301230639696328e+01 -6.1562225607106335e+01 1.0823084411554899e+04
 1.8620170719144496e-02 3.4365559881198342e+00 -1.8940460118450687e+01 1.0193175692434127e+03
 3.4494164428552847e-02 3.6416518769072868e+00 -1.9829497378559118e+01 2.1878546266854419e+03
 3.2525446295456076e-02 2.1354007870574954e+00 -1.2761584386901678e+01 2.2435788128601098e+03
 7.4315404828221975e-03 -1.4162774383872860e+00 -6.7016821577673635e-01 5.6724468129223908e+02
 1.0194106324223216e-02 -2.0733754635359132e+00 -1.3211951740013457e+00 7.6498703626840916e+02
 1.3018982993736486e-02 -2.4841606065169088e+00 -2.0850606851644780e+00 9.7255011635937683e+02
 1.4065738120777547e-02 -2.2770822548771306e+00 -2.3828954720456292e+00 1.0594260597726407e+03
 1.3640564187699850e-02 -1.8302298657265454e+00 -2.3455938574197721e+00 1.0367702066529425e+03
 1.2497915562227929e-02 -3.8612789252613458e+00 -4.8005685064675765e+00 8.5842216215222174e+02
 3.1274364862674486e-02 -3.4784024909622802e+00 -7.6903437804165424e+00 2.3088416864941701e+03
 3.0708390075161414e-02 -2.3982515731955489e+00 -1.5028375846026227e+01 2.2459948118591042e+03
 4.4124706368817386e-02 -1.9127712222307522e+00 -1.3266804952300777e+01 3.1971474495107182e+03
 1.6373219490317503e-02 1.2787091657351937e+00 -8.0128881946501718e+00 1.1975282956441401e+03
 2.2373822870687069e-02 9.6988759071486597e-01 -6.7270508631078094e+00 1.6211419092269175e+03
 6.3896847348921260e-03 1.9741175932599144e+00 -2.4543388164087436e+00 4.3887694383547165e+02
 8.3827919382679708e-03 2.5937647764911782e+00 -3.4336942507917723e+00 5.5104407619074129e+02
 1.0803507036648370e-02 2.3457120951566890e+00 -3.6625251693131817e+00 7.4403940165566280e+02
 1.1414003613732706e-02 1.7510475279208568e+00 -3.2269935114334816e+00 8.1914874083817529e+02
 1.0656335945093732e-02 1.1852207281812426e+00 -2.6203853289180001e+00 7.8670798794327982e+02 ];

X = [ 6.1602435082500018e-01 -6.7290491409251487e+01 -3.6681099255341127e+02 3.8732194523739490e+04
 -2.0290871245848932e-01 1.5769361588453486e+02 -1.0880923693872616e+02 -1.9221042627846000e+04
 3.1494439658275653e-01 6.2535786570242635e+01 1.6647723560058205e+02 2.9813112015912484e+04
 4.3021560346781612e-01 5.2159939217577381e+01 1.4368553480568150e+02 3.7713992536590689e+04
 1.4839021216119563e-01 -1.6049042041429703e+02 9.8322257824558250e+01 4.9838695594134906e+03
 1.2955103503987303e-01 -2.0752749140567279e+00 9.8052607128078989e+01 1.6151658621264933e+04 ];

R = B - A*X

